一、功能总结
1、功能简述
获取当前任务的信息。

2、功能实现
2.1任务信息的内存结构
rcore内核中，任务的控制块结构体为TaskControlBlock，用于保存任务相关的信息。
需要获取的任务信息，包括：运行时间、系统调用次数等，都需要在TaskControlBlock中保存。
为了代码更加简洁，我们首先定义了一个新的结构体TaskStatis，用户定义所有新增的任务信息。
然后在TaskControlBlock结构体中，放入一个TaskStatis类型的成员。

TaskStatis结构体中，starttime用于记录任务启动时的时间，syscall_times用于记录该任务
执行的每一个系统调用的计数。

2.2启动时间的获取
任务的starttime时间在任务被调度时记录，通过判读starttime是否为0,判定是否为初次调度。
任务运行时间在sys_task_info被调用时计算，计算公式为：
current_time - task.starttime

2.3系统调用计数
syscall函数是系统调用的分发函数，所有系统调用通过这个函数分发到具体的处理逻辑。
在syscall函数增加系统调用的计数逻辑，这样实现比较简单，本作业采用这种实现方式。

二、简答作业
1、正确进入 U 态后，程序的特征还应有：使用 S 态特权指令，访问 S 态寄存器后会报错。 请同学们可以自行测试这些内容（运行 三个 bad 测例 (ch2b_bad_*.rs) ）， 描述程序出错行为，同时注意注明你使用的 sbi 及其版本。
答：当在U态使用S态特权指令时，CPU会产生一个异常，由内核进行处理，内核会报“IllegalInstruction in application, kernel killed it.”错误，并杀死异常的进程。
当在U态访问 S 态寄存器时，CPU会产生一个异常，由内核进行处理，内核会报“IllegalInstruction in application, kernel killed it.”错误，并杀死异常的进程。

2、深入理解 trap.S 中两个函数 __alltraps 和 __restore 的作用，并回答如下问题:
 1）L40：刚进入 __restore 时，a0 代表了什么值。请指出 __restore 的两种使用情景。
 答：a0代表由内核回到用户态的返回值，__restore在两个地方使用，一是当新建任务时，使任务在创建完成后从内核态切换到用户态；二是任务运行过程中，当内核处理完异常后，可以切换回用户态继续执行任务。

 2）L43-L48：这几行汇编代码特殊处理了哪些寄存器？这些寄存器的的值对于进入用户态有何意义？请分别解释。
 答：处理了sstatus,sepc,sscratch三个寄存器。sstatus用于存放用户态机器状态信息，sepc用于存放用户态当前的指令指针，sscratch用户保存用户态当前的栈帧。以上三个寄存器的处理，使机器状态回到异常发生时的状态，使被异常打断的任务可以继续执行。

 3）L50-L56：为何跳过了 x2 和 x4？
 答：x4不会被用到，所以不用保存和恢复。x2是堆栈指针，用户态的堆栈指针保存在sscratch中，因此也不需要单独保存和恢复。

 4）L60：该指令之后，sp 和 sscratch 中的值分别有什么意义？
 答：该指令后，sp指向用户态栈帧，sscratch中保存内核栈帧。

 5）__restore：中发生状态切换在哪一条指令？为何该指令执行之后会进入用户态？
 答：L61 sret指令，因为这条指令回从堆栈中读取返回地址，使CPU从该返回地址继续执行指令。

 6）L13：该指令之后，sp 和 sscratch 中的值分别有什么意义？
 答：该指令后，sp指向内核态栈帧，sscratch指向用户态栈帧。

 7）从 U 态进入 S 态是哪一条指令发生的？
 答：L13指令。

三、荣誉准则
1、在完成本次实验的过程（含此前学习的过程）中，我曾分别与 以下各位 就（与本次实验相关的）以下方面做过交流，还在代码中对应的位置以注释形式记录了具体的交流对象及内容：

    无。

2、此外，我也参考了 以下资料 ，还在代码中对应的位置以注释形式记录了具体的参考来源及内容：

    无。

3、我独立完成了本次实验除以上方面之外的所有工作，包括代码与文档。 我清楚地知道，从以上方面获得的信息在一定程度上降低了实验难度，可能会影响起评分。

4、我从未使用过他人的代码，不管是原封不动地复制，还是经过了某些等价转换。 我未曾也不会向他人（含此后各届同学）复制或公开我的实验代码，我有义务妥善保管好它们。 我提交至本实验的评测系统的代码，均无意于破坏或妨碍任何计算机系统的正常运转。 我清楚地知道，以上情况均为本课程纪律所禁止，若违反，对应的实验成绩将按“-100”分计。
  
